<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel - Pok√©Gems Wiki</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="admin-container">
    <h1>Admin Panel</h1>

    <!-- Newsfeed Form -->
    <form id="newsfeed-form">
      <label for="news-title">News Title</label>
      <input type="text" id="news-title" placeholder="Enter title..." required />

      <label for="news-content">News Content</label>
      <textarea id="news-content" placeholder="Write the news content..." required></textarea>

      <label for="news-media">Upload Media</label>
      <input type="file" id="news-media" accept="image/*,video/*" />

      <button type="submit">Post News</button>
    </form>

    <div id="preview" class="preview-container">
      <h2>Preview</h2>
      <div id="preview-content"></div>
    </div>
  </div>

  <script>
    const form = document.getElementById("newsfeed-form");

    // Handle form submission
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const title = document.getElementById("news-title").value;
      const content = document.getElementById("news-content").value;
      const mediaInput = document.getElementById("news-media");
      let mediaHTML = "";

      // Handle media upload
      if (mediaInput.files.length > 0) {
        const file = mediaInput.files[0];
        const mediaURL = URL.createObjectURL(file);

        if (file.type.startsWith("image")) {
          mediaHTML = `<img src="${mediaURL}" alt="News Image" style="max-width: 100%;">`;
        } else if (file.type.startsWith("video")) {
          mediaHTML = `<video controls style="max-width: 100%;"><source src="${mediaURL}" type="${file.type}"></video>`;
        }
      }

      // Create news block HTML
      const newsHTML = `
        <div class="news-item">
          <h3>${title}</h3>
          <p>${content}</p>
          ${mediaHTML}
        </div>
      `;

      // Send the post to the server
      try {
        const response = await fetch("/update-newsfeed", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ newsHTML }),
        });

        if (response.ok) {
          alert("Newsfeed updated successfully!");
        } else {
          throw new Error("Failed to update newsfeed");
        }
      } catch (error) {
        console.error("Error:", error);
        alert("Error updating newsfeed");
      }

      form.reset(); // Clear form
    });
  </script>
</body>
</html>
